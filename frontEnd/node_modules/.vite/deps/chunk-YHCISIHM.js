import {
  socialAuthOptions
} from "./chunk-3RUNIGMR.js";
import {
  UserWalletStatus
} from "./chunk-SPYT4SSF.js";
import {
  ethereum
} from "./chunk-TT4DF327.js";

// node_modules/thirdweb/dist/esm/wallets/in-app/core/wallet/index.js
function isInAppWallet(wallet) {
  return wallet.id === "inApp" || wallet.id === "embedded";
}
async function connectInAppWallet(options, createOptions, connector) {
  var _a;
  if (((_a = createOptions == null ? void 0 : createOptions.auth) == null ? void 0 : _a.mode) === "redirect" && connector.authenticateWithRedirect) {
    const strategy = options.strategy;
    if (socialAuthOptions.includes(strategy)) {
      connector.authenticateWithRedirect(strategy);
    }
  }
  const authResult = await connector.authenticate(options);
  const authAccount = authResult.user.account;
  if (createOptions && "smartAccount" in createOptions && (createOptions == null ? void 0 : createOptions.smartAccount)) {
    return convertToSmartAccount({
      client: options.client,
      authAccount,
      smartAccountOptions: createOptions.smartAccount,
      chain: options.chain
    });
  }
  return [authAccount, options.chain || ethereum];
}
async function autoConnectInAppWallet(options, createOptions, connector) {
  if (options.authResult && connector.loginWithAuthToken) {
    await connector.loginWithAuthToken(options.authResult);
  }
  const user = await getAuthenticatedUser(connector);
  if (!user) {
    throw new Error("Failed to authenticate user.");
  }
  const authAccount = user.account;
  if (createOptions && "smartAccount" in createOptions && (createOptions == null ? void 0 : createOptions.smartAccount)) {
    return convertToSmartAccount({
      client: options.client,
      authAccount,
      smartAccountOptions: createOptions.smartAccount,
      chain: options.chain
    });
  }
  return [authAccount, options.chain || ethereum];
}
async function convertToSmartAccount(options) {
  const [{ smartWallet }, { connectSmartWallet }] = await Promise.all([
    import("./smart-wallet-XSLV2MJP.js"),
    import("./smart-YZU3KMOU.js")
  ]);
  const sa = smartWallet(options.smartAccountOptions);
  return connectSmartWallet(sa, {
    client: options.client,
    personalAccount: options.authAccount,
    chain: options.chain
  }, options.smartAccountOptions);
}
async function getAuthenticatedUser(connector) {
  const user = await connector.getUser();
  switch (user.status) {
    case UserWalletStatus.LOGGED_IN_WALLET_INITIALIZED: {
      return user;
    }
  }
  return void 0;
}

export {
  isInAppWallet,
  connectInAppWallet,
  autoConnectInAppWallet
};
//# sourceMappingURL=chunk-YHCISIHM.js.map
